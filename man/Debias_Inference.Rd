% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core.R
\name{Debias_Inference}
\alias{Debias_Inference}
\title{Debiased Inference for Penalised Mixed-Effects QR}
\usage{
Debias_Inference(
  y,
  X,
  Z,
  cluster_id,
  beta_hat,
  gamma_hat,
  tau,
  h,
  lambda2,
  lambda_clime = NULL,
  method = c("CLIME", "RIDGE"),
  ...
)
}
\arguments{
\item{y}{Numeric response vector.}

\item{X}{Fixed-effect design matrix.}

\item{Z}{Random-effect design matrix.}

\item{cluster_id}{Cluster labels.}

\item{beta_hat}{Penalised fixed-effect estimate.}

\item{gamma_hat}{Penalised random-effect estimate matrix by cluster.}

\item{tau}{Target quantile.}

\item{h}{Smoothing bandwidth.}

\item{lambda2}{Ridge penalty level used in fitting.}

\item{lambda_clime}{Optional CLIME tuning level.}

\item{method}{Debiasing method: \code{"CLIME"} or \code{"RIDGE"}.}

\item{...}{Additional arguments passed to the chosen method.}
}
\value{
A list with debiased estimates, standard errors, and variance diagnostics.
}
\description{
Applies Schur-complement adjustment and precision-matrix estimation
(CLIME or ridge inverse) to obtain debiased estimates and standard errors.
}
\examples{
set.seed(3)
dat <- generate_mixed_qr_data(
  n = 10, p = 12, s = 3, tau = 0.5,
  scenario = "S1", m_choices = c(2, 3)
)
active <- CA_IQR_SIS(dat$y, dat$X, dat$cluster_id, d_target = 5, T_iter = 1)
X_sub <- dat$X[, active, drop = FALSE]
fit <- JP_DME_QR(
  y = dat$y,
  X = X_sub,
  Z = dat$Z,
  cluster_id = dat$cluster_id,
  tau = 0.5,
  h = dat$N^(-1 / 3),
  lambda1 = 0.1,
  lambda2 = 1,
  max_iter = 10,
  tol = 1e-3,
  obj_tol = 1e-4
)
inf <- Debias_Inference(
  y = dat$y,
  X = X_sub,
  Z = dat$Z,
  cluster_id = dat$cluster_id,
  beta_hat = fit$beta,
  gamma_hat = fit$gamma,
  tau = 0.5,
  h = dat$N^(-1 / 3),
  lambda2 = 1,
  method = "RIDGE"
)
head(inf$beta_tilde)
}
