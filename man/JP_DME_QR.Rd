% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core.R
\name{JP_DME_QR}
\alias{JP_DME_QR}
\title{Joint Penalised Mixed-Effects Quantile Regression}
\usage{
JP_DME_QR(
  y,
  X,
  Z,
  cluster_id,
  tau,
  h,
  lambda1,
  lambda2,
  max_iter = 100,
  tol = 1e-04,
  obj_tol = 1e-06,
  initial_beta = NULL,
  beta_cd_max_iter = 200,
  beta_cd_tol = 1e-06,
  verbose = FALSE
)
}
\arguments{
\item{y}{Numeric response vector.}

\item{X}{Fixed-effect design matrix.}

\item{Z}{Random-effect design matrix.}

\item{cluster_id}{Cluster labels.}

\item{tau}{Target quantile in \verb{(0, 1)}.}

\item{h}{Smoothing bandwidth.}

\item{lambda1}{\code{L1} penalty level for fixed effects.}

\item{lambda2}{Ridge penalty level for random effects.}

\item{max_iter}{Maximum outer BCD iterations.}

\item{tol}{Outer-loop convergence tolerance for parameter changes.}

\item{obj_tol}{Relative objective-change tolerance.}

\item{initial_beta}{Optional initialization for \code{beta}.}

\item{beta_cd_max_iter}{Maximum inner iterations for beta subproblem.}

\item{beta_cd_tol}{Convergence tolerance for beta subproblem.}

\item{verbose}{Logical; print progress if \code{TRUE}.}
}
\value{
A list containing penalised estimates, diagnostics, and convergence info.
}
\description{
Fits the smoothed objective using block coordinate descent with
an \code{L1} penalty on fixed effects and ridge penalty on random effects.
}
\examples{
set.seed(2)
dat <- generate_mixed_qr_data(
  n = 10, p = 12, s = 3, tau = 0.5,
  scenario = "S1", m_choices = c(2, 3)
)
active <- CA_IQR_SIS(dat$y, dat$X, dat$cluster_id, d_target = 5, T_iter = 1)
fit <- JP_DME_QR(
  y = dat$y,
  X = dat$X[, active, drop = FALSE],
  Z = dat$Z,
  cluster_id = dat$cluster_id,
  tau = 0.5,
  h = dat$N^(-1 / 3),
  lambda1 = 0.1,
  lambda2 = 1,
  max_iter = 10,
  tol = 1e-3,
  obj_tol = 1e-4
)
fit$converged
}
